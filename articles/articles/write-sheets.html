<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Write Sheets • googlesheets4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../tidyverse-2.css" rel="stylesheet">
<meta property="og:title" content="Write Sheets">
<meta property="og:description" content="">
<meta property="og:image" content="https://googlesheets4.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html">googlesheets4</a>
        <div class="info">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../articles/googlesheets4.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/auth.html">googlesheets4 auth</a>
    </li>
    <li>
      <a href="../../articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    </li>
    <li>
      <a href="../../articles/articles/find-identify-sheets.html">Find and Identify Sheets</a>
    </li>
    <li>
      <a href="../../articles/articles/fun-with-googledrive-and-readxl.html">Fun with googledrive and readxl</a>
    </li>
    <li>
      <a href="../../articles/articles/googlesheets4-reprex.html">How to create a googlesheets4 reprex</a>
    </li>
    <li>
      <a href="../../articles/articles/range-specification.html">Range specification</a>
    </li>
    <li>
      <a href="../../articles/articles/read-sheets.html">Read Sheets</a>
    </li>
    <li>
      <a href="../../articles/articles/write-sheets.html">Write Sheets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/tidyverse/googlesheets4">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Write Sheets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/master/vignettes/articles/write-sheets.Rmd"><code>vignettes/articles/write-sheets.Rmd</code></a></small>
      <div class="hidden name"><code>write-sheets.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(googlesheets4)</span></code></pre></div>
<p>Basic Sheet writing is shown in the <a href="https://googlesheets4.tidyverse.org/articles/googlesheets4.html">Get started</a> article. Here we explore the different uses for the writing functions:</p>
<ul>
<li>
<code><a href="../../reference/sheets_create.html">sheets_create()</a></code> emphasizes the creation of a new (spread)Sheet.
<ul>
<li>But it can create (work)sheets and write data.</li>
</ul>
</li>
<li>
<code><a href="../../reference/write_sheet.html">sheets_write()</a></code> emphasizes writing a data frame into a (work)sheet.
<ul>
<li>But it can create a new (spread)Sheet or a new (work)sheet.</li>
</ul>
</li>
<li>
<code><a href="../../reference/sheets_append.html">sheets_append()</a></code> is about adding rows to an existing data table.</li>
<li>
<code><a href="../../reference/sheets_create.html">sheets_create()</a></code>, <code><a href="../../reference/write_sheet.html">sheets_write()</a></code>, and <code><a href="../../reference/sheets_append.html">sheets_append()</a></code> implement holistic operations for representing a single R data frame as a table in a (work)sheet within a Google Sheet.
<ul>
<li>
<code><a href="../../reference/sheets_create.html">sheets_create()</a></code> and <code><a href="../../reference/write_sheet.html">sheets_write()</a></code> both impose this mentality via specific formatting, such as special treatment of the column header row.</li>
<li>All 3 functions aim to shrink-wrap the data.</li>
</ul>
</li>
<li>
<code><a href="../../reference/sheets_edit.html">sheets_edit()</a></code> is the one function that helps you write arbitrary data into an arbitrary range, although it is still oriented around a data frame.</li>
</ul>
<div id="auth" class="section level2">
<h2 class="hasAnchor">
<a href="#auth" class="anchor"></a>Auth</h2>
<p>As a regular, interactive user, you can just let googlesheets4 prompt you for anything it needs re: auth.</p>
<p>Since this article is compiled noninteractively on a server, we have arranged for googlesheets4 to use a service account token (not shown).</p>
</div>
<div id="sheets_create" class="section level2">
<h2 class="hasAnchor">
<a href="#sheets_create" class="anchor"></a><code>sheets_create()</code>
</h2>
<p>Create a brand new Sheet with <code><a href="../../reference/sheets_create.html">sheets_create()</a></code>. You can specify the new Sheet’s <code>name</code> (or accept a randomly generated name).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>ss1 &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(<span class="st">"sheets-create-demo-1"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>ss1</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt;   Spreadsheet name: sheets-create-demo-1</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt;                 ID: 1z8-XY1FZsXEKuOh0X_F212wVzIXQMqzWfP-St3ObYA4</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; </span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt;       Sheet1: 1000 x 26</span></span></code></pre></div>
<p>Every Sheet <em>must</em> have at least one (work)sheet, so Google Sheets automatically creates an empty “Sheet1”.</p>
<p>You can control the names and content of the initial (work)sheets with the <code>sheets</code> argument.</p>
<div id="send-sheet-names" class="section level3">
<h3 class="hasAnchor">
<a href="#send-sheet-names" class="anchor"></a>Send sheet names</h3>
<p>Use a character vector to specify the names of one or more empty sheets.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>ss2 &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="st">"sheets-create-demo-2"</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">sheets =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"alpha"</span>, <span class="st">"beta"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>ss2</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt;   Spreadsheet name: sheets-create-demo-2</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt;                 ID: 16PUv-Imo7ZMlaGGHaHDwon5DKJPpi5R02etZ4THVEkY</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt;        # of sheets: 2</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt;        alpha: 1000 x 26</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt;         beta: 1000 x 26</span></span></code></pre></div>
<p>These sheets have no values and get their dimensions from Sheets default behaviour.</p>
</div>
<div id="send-a-data-frame" class="section level3">
<h3 class="hasAnchor">
<a href="#send-a-data-frame" class="anchor"></a>Send a data frame</h3>
<p>If you provide a data frame, it is used to populate the cells of a sheet and to set sheet dimensions (number of rows and columns). The header row also gets special treatment. The sheet inherits the name of the data frame, where possible.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>my_data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>ss3 &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="st">"sheets-create-demo-3"</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="dt">sheets =</span> my_data</span>
<span id="cb4-6"><a href="#cb4-6"></a>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>ss3</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt;   Spreadsheet name: sheets-create-demo-3</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt;                 ID: 1gXlAjQWcv7BzDy4q44RiShLEfqEm8SDD7OsB3_k_tLg</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt;      my_data: 4 x 2</span></span></code></pre></div>
</div>
<div id="send-multiple-data-frames" class="section level3">
<h3 class="hasAnchor">
<a href="#send-multiple-data-frames" class="anchor"></a>Send multiple data frames</h3>
<p>If you provide a list of data frames, each is used to populate the cells of one sheet and to set sheet dimensions (number of rows and columns). The header row also gets special treatment. The sheets inherit the names from the list, if it has names.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>my_data_frames &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">iris =</span> <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(iris), <span class="dt">chickwts =</span> <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(chickwts))</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>ss4 &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="st">"sheets-create-demo-4"</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="dt">sheets =</span> my_data_frames</span>
<span id="cb5-6"><a href="#cb5-6"></a>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>ss4</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;   Spreadsheet name: sheets-create-demo-4</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;                 ID: 1Digh7cWxVk-ZInC4JHuNyfYaFPRpPe-fk_FDuSFxCuY</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt;        # of sheets: 2</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; </span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;         iris: 7 x 5</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt;     chickwts: 7 x 2</span></span></code></pre></div>
</div>
<div id="write-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#write-metadata" class="anchor"></a>Write metadata</h3>
<p>Most users won’t need to do this, but <code><a href="../../reference/sheets_create.html">sheets_create()</a></code> can set additional Sheet-level metadata, such as locale or time zone. To really make use of this feature, you need to read up on the <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/create"><code>spreadsheets.create</code> endpoint</a>.</p>
<p>Notice how the default empty Sheet here is named “Feuille 1”, since we request a French locale.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>ss5 &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="st">"sheets-create-demo-5"</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="dt">locale =</span> <span class="st">"fr_FR"</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="dt">timeZone =</span> <span class="st">"Europe/Paris"</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>)</span>
<span id="cb6-6"><a href="#cb6-6"></a>ss5</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt;   Spreadsheet name: sheets-create-demo-5</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt;                 ID: 1SI8hczsBujWKmuJf7PEoDX86mlDLgWEdQuqgHJ2_DE8</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt;             Locale: fr_FR</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt;          Time zone: Europe/Paris</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt;    Feuille 1: 1000 x 26</span></span></code></pre></div>
<p>I would only do this if you have specific evidence that the default behaviour with respect to locale and time zone is problematic for your use case.</p>
</div>
<div id="clean-up" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up" class="anchor"></a>Clean up</h3>
<p>Trash all the Sheets created above. This actually requires googledrive, since it is not possible to trash or delete Sheets through the Sheets API. In our hidden auth process, described earlier, we put a shared token into force for both Sheets and Drive. You can read how to do that in your own work in the article <a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="../../reference/sheets_find.html">sheets_find</a></span>(<span class="st">"sheets-create-demo"</span>) <span class="op">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">  </span>googledrive<span class="op">::</span><span class="kw"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span>()</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; Files trashed:</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt;   * sheets-create-demo-5: 1SI8hczsBujWKmuJf7PEoDX86mlDLgWEdQuqgHJ2_DE8</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt;   * sheets-create-demo-4: 1Digh7cWxVk-ZInC4JHuNyfYaFPRpPe-fk_FDuSFxCuY</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt;   * sheets-create-demo-3: 1gXlAjQWcv7BzDy4q44RiShLEfqEm8SDD7OsB3_k_tLg</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt;   * sheets-create-demo-2: 16PUv-Imo7ZMlaGGHaHDwon5DKJPpi5R02etZ4THVEkY</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt;   * sheets-create-demo-1: 1z8-XY1FZsXEKuOh0X_F212wVzIXQMqzWfP-St3ObYA4</span></span></code></pre></div>
</div>
</div>
<div id="write_sheet-a-k-a--sheets_write" class="section level2">
<h2 class="hasAnchor">
<a href="#write_sheet-a-k-a--sheets_write" class="anchor"></a><code>write_sheet()</code>, a.k.a. <code>sheets_write()</code>
</h2>
<p><code><a href="../../reference/write_sheet.html">write_sheet()</a></code> is aliased to <code><a href="../../reference/write_sheet.html">sheets_write()</a></code> and is meant to evoke <code><a href="https://readr.tidyverse.org/reference/write_delim.html">readr::write_csv()</a></code> or <code>writexl::write_xlsx()</code>. Whereas <code><a href="../../reference/sheets_create.html">sheets_create()</a></code> emphasizes the <em>target Sheet</em>, <code><a href="../../reference/write_sheet.html">sheets_write()</a></code> emphasizes the <em>data you want to write</em>.</p>
<p>The only required argument for <code><a href="../../reference/write_sheet.html">sheets_write()</a></code> is the data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>random_ss &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/write_sheet.html">sheets_write</a></span>(df)</span>
<span id="cb8-4"><a href="#cb8-4"></a>random_ss</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;   Spreadsheet name: likeminded-ass</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt;                 ID: 1DrTlSPM8YOJLU--9mxyiG5GQDhN_E3lRumYsLA7-L3M</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; </span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt;           df: 4 x 2</span></span></code></pre></div>
<p>This creates a new (work)sheet inside a new (spread)Sheet and returns its ID. You’ll notice the new Sheet has a randomly generated name. If that is a problem, use <code><a href="../../reference/sheets_create.html">sheets_create()</a></code> instead, which affords more control over various aspects of the new Sheet.</p>
<p>Let’s start over: we delete that Sheet and call <code><a href="../../reference/sheets_create.html">sheets_create()</a></code>, so we can specify the new Sheet’s name. Then we’ll modify it with <code><a href="../../reference/write_sheet.html">sheets_write()</a></code>. We send one sheet name, “chickwts”, to prevent the creation of “Sheet1”, but we send no data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>googledrive<span class="op">::</span><span class="kw"><a href="https://googledrive.tidyverse.org/reference/drive_rm.html">drive_rm</a></span>(random_ss)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; Files deleted:</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;   * likeminded-ass: 1DrTlSPM8YOJLU--9mxyiG5GQDhN_E3lRumYsLA7-L3M</span></span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a>ss1 &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(</span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="st">"write-sheets-demo-1"</span>,</span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="dt">sheets =</span> <span class="st">"chickwts"</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>ss1</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt;   Spreadsheet name: write-sheets-demo-1</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;                 ID: 1WqF_X0p583cV2ufduF8hpYrjEDWCSi3naCSZr3X16AM</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt;     chickwts: 1000 x 26</span></span></code></pre></div>
<p><code><a href="../../reference/write_sheet.html">sheets_write()</a></code> allows us to write the actual <code>chickwts</code> data into the sheet by that name.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="../../reference/write_sheet.html">sheets_write</a></span>(chickwts, <span class="dt">ss =</span> ss1, <span class="dt">sheet =</span> <span class="st">"chickwts"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; Writing to "write-sheets-demo-1"</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt; Writing to sheet "chickwts"</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>ss1</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt;   Spreadsheet name: write-sheets-demo-1</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt;                 ID: 1WqF_X0p583cV2ufduF8hpYrjEDWCSi3naCSZr3X16AM</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; </span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt;     chickwts: 72 x 2</span></span></code></pre></div>
<p><code><a href="../../reference/write_sheet.html">sheets_write()</a></code> can also write data into a new sheet, if <code>sheet</code> implicitly or explicitly targets a non-existent sheet.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># explicitly make a new sheet named "iris"</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw"><a href="../../reference/write_sheet.html">sheets_write</a></span>(iris, <span class="dt">ss =</span> ss1, <span class="dt">sheet =</span> <span class="st">"iris"</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; Writing to "write-sheets-demo-1"</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; Writing to sheet "iris"</span></span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co"># implicitly make a new sheet named "mtcars"</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="kw"><a href="../../reference/write_sheet.html">sheets_write</a></span>(mtcars, <span class="dt">ss =</span> ss1)</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; Writing to "write-sheets-demo-1"</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; Writing to sheet "mtcars"</span></span></code></pre></div>
<p>If no sheet name is given and it can’t be determined from <code>data</code>, a name of the form “SheetN” is automatically generated by Sheets.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw"><a href="../../reference/write_sheet.html">sheets_write</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">ss =</span> ss1)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; Writing to "write-sheets-demo-1"</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; Writing to sheet "Sheet1"</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>ss1</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt;   Spreadsheet name: write-sheets-demo-1</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt;                 ID: 1WqF_X0p583cV2ufduF8hpYrjEDWCSi3naCSZr3X16AM</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt;        # of sheets: 4</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;     chickwts: 72 x 2</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt;         iris: 151 x 5</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt;       mtcars: 33 x 11</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt;       Sheet1: 3 x 2</span></span></code></pre></div>
<div id="clean-up-1" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-1" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="../../reference/sheets_find.html">sheets_find</a></span>(<span class="st">"write-sheets-demo"</span>) <span class="op">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span>googledrive<span class="op">::</span><span class="kw"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span>()</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; Files trashed:</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt;   * write-sheets-demo-1: 1WqF_X0p583cV2ufduF8hpYrjEDWCSi3naCSZr3X16AM</span></span></code></pre></div>
</div>
</div>
<div id="sheets_append" class="section level2">
<h2 class="hasAnchor">
<a href="#sheets_append" class="anchor"></a><code>sheets_append()</code>
</h2>
<p><code><a href="../../reference/sheets_append.html">sheets_append()</a></code> can add one or more rows of data to an existing (work)sheet.</p>
<p>Let’s recreate the table of “other” deaths from an example Sheet, but without the annoying text above and below the data. First we bring that data into a local data frame and chop it into pieces.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>(deaths &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_example.html">sheets_example</a></span>(<span class="st">"deaths"</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">   </span><span class="kw"><a href="../../reference/read_sheet.html">sheets_read</a></span>(<span class="dt">range =</span> <span class="st">"other_data"</span>, <span class="dt">col_types =</span> <span class="st">"????DD"</span>))</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; Reading from "deaths"</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; Range "other_data"</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; # A tibble: 10 x 6</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt;    Name           Profession   Age `Has kids` `Date of birth` `Date of death`</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;date&gt;          &lt;date&gt;         </span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt;  1 Vera Rubin     scientist     88 TRUE       1928-07-23      2016-12-25     </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt;  2 Mohamed Ali    athlete       74 TRUE       1942-01-17      2016-06-03     </span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt;  3 Morley Safer   journalist    84 TRUE       1931-11-08      2016-05-19     </span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt;  4 Fidel Castro   politician    90 TRUE       1926-08-13      2016-11-25     </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt;  5 Antonin Scalia lawyer        79 TRUE       1936-03-11      2016-02-13     </span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt;  6 Jo Cox         politician    41 TRUE       1974-06-22      2016-06-16     </span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">#&gt;  7 Janet Reno     lawyer        78 FALSE      1938-07-21      2016-11-07     </span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">#&gt;  8 Gwen Ifill     journalist    61 FALSE      1955-09-29      2016-11-14     </span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">#&gt;  9 John Glenn     astronaut     95 TRUE       1921-07-28      2016-12-08     </span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">#&gt; 10 Pat Summit     coach         64 TRUE       1952-06-14      2016-06-28</span></span>
<span id="cb14-18"><a href="#cb14-18"></a></span>
<span id="cb14-19"><a href="#cb14-19"></a>deaths_zero  &lt;-<span class="st"> </span>deaths[<span class="kw"><a href="https://rdrr.io/r/base/integer.html">integer</a></span>(), ] <span class="co"># "scaffolding" data frame with 0 rows</span></span>
<span id="cb14-20"><a href="#cb14-20"></a>deaths_one   &lt;-<span class="st"> </span>deaths[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, ] </span>
<span id="cb14-21"><a href="#cb14-21"></a>deaths_two   &lt;-<span class="st"> </span>deaths[<span class="dv">6</span>, ]</span>
<span id="cb14-22"><a href="#cb14-22"></a>deaths_three &lt;-<span class="st"> </span>deaths[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>, ]</span></code></pre></div>
<p>We use <code><a href="../../reference/sheets_create.html">sheets_create()</a></code> to create a new (spread)Sheet and initialize a new (work)sheet with the “deaths” column headers, but no data. A second empty row is created (it must be, in order for us to freeze the top row), but it will soon be filled when we append.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>ss &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(<span class="st">"sheets-append-demo"</span>, <span class="dt">sheets =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">deaths =</span> deaths_zero))</span>
<span id="cb15-2"><a href="#cb15-2"></a>ss</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt;   Spreadsheet name: sheets-append-demo</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt;                 ID: 19OxjLgDs6MAUcIWAFzHob3UXwVvZ1CAwj_Reh5svp7I</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; </span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt;       deaths: 2 x 6</span></span></code></pre></div>
<p>If you’re following along, I recommend you open this Sheet in a web browser with <code><a href="../../reference/sheets_browse.html">sheets_browse()</a></code> and revisit as we go along, to see how the initial empty row gets consumed and how additional rows are added to the targetted sheet automatically.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw"><a href="../../reference/sheets_browse.html">sheets_browse</a></span>(ss)</span></code></pre></div>
<p>Send the data, one or more rows at a time. Keep inspecting in the browser if you’re doing this yourself.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>ss</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt;   Spreadsheet name: sheets-append-demo</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt;                 ID: 19OxjLgDs6MAUcIWAFzHob3UXwVvZ1CAwj_Reh5svp7I</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">#&gt; </span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt;       deaths: 2 x 6</span></span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co"># send several rows</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="kw"><a href="../../reference/sheets_append.html">sheets_append</a></span>(deaths_one, ss)</span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">#&gt; Writing to "sheets-append-demo"</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co">#&gt; Appending 5 row(s) to "deaths"</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>ss</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co">#&gt;   Spreadsheet name: sheets-append-demo</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co">#&gt;                 ID: 19OxjLgDs6MAUcIWAFzHob3UXwVvZ1CAwj_Reh5svp7I</span></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="co">#&gt; </span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="co">#&gt;       deaths: 6 x 6</span></span>
<span id="cb17-24"><a href="#cb17-24"></a></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="co"># send a single row</span></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="kw"><a href="../../reference/sheets_append.html">sheets_append</a></span>(deaths_two, ss)</span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="co">#&gt; Writing to "sheets-append-demo"</span></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="co">#&gt; Appending 1 row(s) to "deaths"</span></span>
<span id="cb17-29"><a href="#cb17-29"></a>ss</span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="co">#&gt;   Spreadsheet name: sheets-append-demo</span></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="co">#&gt;                 ID: 19OxjLgDs6MAUcIWAFzHob3UXwVvZ1CAwj_Reh5svp7I</span></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb17-35"><a href="#cb17-35"></a><span class="co">#&gt; </span></span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb17-37"><a href="#cb17-37"></a><span class="co">#&gt;       deaths: 7 x 6</span></span>
<span id="cb17-38"><a href="#cb17-38"></a></span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="co"># send remaining rows</span></span>
<span id="cb17-40"><a href="#cb17-40"></a><span class="kw"><a href="../../reference/sheets_append.html">sheets_append</a></span>(deaths_three, ss)</span>
<span id="cb17-41"><a href="#cb17-41"></a><span class="co">#&gt; Writing to "sheets-append-demo"</span></span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="co">#&gt; Appending 4 row(s) to "deaths"</span></span>
<span id="cb17-43"><a href="#cb17-43"></a>ss</span>
<span id="cb17-44"><a href="#cb17-44"></a><span class="co">#&gt;   Spreadsheet name: sheets-append-demo</span></span>
<span id="cb17-45"><a href="#cb17-45"></a><span class="co">#&gt;                 ID: 19OxjLgDs6MAUcIWAFzHob3UXwVvZ1CAwj_Reh5svp7I</span></span>
<span id="cb17-46"><a href="#cb17-46"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb17-47"><a href="#cb17-47"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb17-48"><a href="#cb17-48"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="co">#&gt; </span></span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb17-51"><a href="#cb17-51"></a><span class="co">#&gt;       deaths: 11 x 6</span></span></code></pre></div>
<p>Now the big reveal: have we successfully rebuilt that data through incremental updates?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>deaths_replica &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/read_sheet.html">sheets_read</a></span>(ss, <span class="dt">col_types =</span> <span class="st">"????DD"</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#&gt; Reading from "sheets-append-demo"</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; Range "deaths"</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(deaths, deaths_replica)</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Gosh I hope that’s still <code>TRUE</code> as it was the last time I checked this article!</p>
<div id="clean-up-2" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-2" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="../../reference/sheets_find.html">sheets_find</a></span>(<span class="st">"sheets-append-demo"</span>) <span class="op">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="st">  </span>googledrive<span class="op">::</span><span class="kw"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span>()</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; Files trashed:</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt;   * sheets-append-demo: 19OxjLgDs6MAUcIWAFzHob3UXwVvZ1CAwj_Reh5svp7I</span></span></code></pre></div>
</div>
</div>
<div id="sheets_edit" class="section level2">
<h2 class="hasAnchor">
<a href="#sheets_edit" class="anchor"></a><code>sheets_edit()</code>
</h2>
<p><code><a href="../../reference/sheets_edit.html">sheets_edit()</a></code> is the least opinionated writing function. It writes data into a range. It does no explicit formatting, although it can effectively apply formatting by <em>clearing</em> existing formats via <code>reformat = TRUE</code> (the default).</p>
<p>We focus here on the geometry of <code><a href="../../reference/sheets_edit.html">sheets_edit()</a></code>, i.e. which cells are edited.</p>
<p>In a hidden chunk, we’ve created a demo Sheet <code>ss_edit</code> and we’ve filled the cells with “-”. We’ve also created <code>read_this()</code>, a wrapper around <code><a href="../../reference/read_sheet.html">sheets_read()</a></code> that names columns by letter, like spreadsheets do.</p>
<p>Here’s the initial state of <code>ss_edit</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">read_this</span>(ss_edit)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">#&gt; Reading from "sheets-edit-demo"</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#&gt; Range "Sheet1"</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt; # A tibble: 7 x 7</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt;   A     B     C     D     E     F     G    </span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; 1 -     -     -     -     -     -     -    </span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt; 2 -     -     -     -     -     -     -    </span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt; 3 -     -     -     -     -     -     -    </span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#&gt; 4 -     -     -     -     -     -     -    </span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; 5 -     -     -     -     -     -     -    </span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt; 6 -     -     -     -     -     -     -    </span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt; 7 -     -     -     -     -     -     -</span></span></code></pre></div>
<p><code>df</code> is a small data frame we’ll send as the <code>data</code> argument of <code><a href="../../reference/sheets_edit.html">sheets_edit()</a></code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>(df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">V1 =</span> <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(LETTERS,<span class="dv">3</span>), <span class="dt">V2 =</span> <span class="kw"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(LETTERS, <span class="dv">3</span>)))</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">#&gt; # A tibble: 3 x 2</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#&gt;   V1    V2   </span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">#&gt; 1 A     X    </span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">#&gt; 2 B     Y    </span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">#&gt; 3 C     Z</span></span></code></pre></div>
<p>If we do not specify the range, <code>df</code> is written into the upper left corner and only affects cells spanned by <code>df</code>. To see where we’ve written, focus on the cells are NOT “x”.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="../../reference/sheets_edit.html">sheets_edit</a></span>(ss_edit, <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_this</span>()</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#&gt; Editing "sheets-edit-demo"</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt; Writing to sheet "Sheet1"</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt; Reading from "sheets-edit-demo"</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; Range "Sheet1"</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt; # A tibble: 7 x 7</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt;   A     B     C     D     E     F     G    </span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#&gt; 1 V1    V2    -     -     -     -     -    </span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">#&gt; 2 A     X     -     -     -     -     -    </span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">#&gt; 3 B     Y     -     -     -     -     -    </span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co">#&gt; 4 C     Z     -     -     -     -     -    </span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co">#&gt; 5 -     -     -     -     -     -     -    </span></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="co">#&gt; 6 -     -     -     -     -     -     -    </span></span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="co">#&gt; 7 -     -     -     -     -     -     -</span></span></code></pre></div>
<p>(Here, and between all subsequent chunks, we reset <code>ss_edit</code> to its initial state.)</p>
<p>If we target a <strong>single cell</strong> with <code>range</code>, it specifies the upper left corner of the target area. The cells written are determined by the extent of the data.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw"><a href="../../reference/sheets_edit.html">sheets_edit</a></span>(ss_edit, <span class="dt">data =</span> df, <span class="dt">range =</span> <span class="st">"C2"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_this</span>()</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt; Editing "sheets-edit-demo"</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt; Writing to sheet "Sheet1"</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt; Reading from "sheets-edit-demo"</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; Range "Sheet1"</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt; # A tibble: 7 x 7</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt;   A     B     C     D     E     F     G    </span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#&gt; 1 -     -     -     -     -     -     -    </span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt; 2 -     -     V1    V2    -     -     -    </span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">#&gt; 3 -     -     A     X     -     -     -    </span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">#&gt; 4 -     -     B     Y     -     -     -    </span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co">#&gt; 5 -     -     C     Z     -     -     -    </span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co">#&gt; 6 -     -     -     -     -     -     -    </span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co">#&gt; 7 -     -     -     -     -     -     -</span></span></code></pre></div>
<p>If <code>range</code> specifies multiple cells (it can even be unbounded on some sides), it is taken literally and all covered cells are written. If <code>range</code> is larger than the data, this results in some cells being <em>cleared</em> of their values. In this example, the <code>range</code> is “too big” for the data, so the remaining cells are cleared of their existing “-” value.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw"><a href="../../reference/sheets_edit.html">sheets_edit</a></span>(ss_edit, <span class="dt">data =</span> df, <span class="dt">range =</span> <span class="st">"D4:G7"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_this</span>()</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">#&gt; Editing "sheets-edit-demo"</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">#&gt; Writing to sheet "Sheet1"</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">#&gt; Reading from "sheets-edit-demo"</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co">#&gt; Range "Sheet1"</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">#&gt; # A tibble: 7 x 7</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">#&gt;   A     B     C     D     E     F     G    </span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co">#&gt; 1 -     -     -     -     -     -     -    </span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">#&gt; 2 -     -     -     -     -     -     -    </span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co">#&gt; 3 -     -     -     -     -     -     -    </span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co">#&gt; 4 -     -     -     V1    V2    &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co">#&gt; 5 -     -     -     A     X     &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co">#&gt; 6 -     -     -     B     Y     &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="co">#&gt; 7 -     -     -     C     Z     &lt;NA&gt;  &lt;NA&gt;</span></span></code></pre></div>
<p>Here’s another case where the <code>range</code> is bigger than it needs to be and it’s unbounded on the bottom and top:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw"><a href="../../reference/sheets_edit.html">sheets_edit</a></span>(ss_edit, <span class="dt">data =</span> df, <span class="dt">range =</span> <span class="st">"B:E"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_this</span>()</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#&gt; Editing "sheets-edit-demo"</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co">#&gt; Writing to sheet "Sheet1"</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">#&gt; Reading from "sheets-edit-demo"</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">#&gt; Range "Sheet1"</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co">#&gt; # A tibble: 7 x 7</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="co">#&gt;   A     B     C     D     E     F     G    </span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co">#&gt; 1 -     V1    V2    NA    NA    -     -    </span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="co">#&gt; 2 -     A     X     NA    NA    -     -    </span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="co">#&gt; 3 -     B     Y     NA    NA    -     -    </span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co">#&gt; 4 -     C     Z     NA    NA    -     -    </span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="co">#&gt; 5 -     &lt;NA&gt;  &lt;NA&gt;  NA    NA    -     -    </span></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="co">#&gt; 6 -     &lt;NA&gt;  &lt;NA&gt;  NA    NA    -     -    </span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="co">#&gt; 7 -     &lt;NA&gt;  &lt;NA&gt;  NA    NA    -     -</span></span></code></pre></div>
<p>Here’s another <code>range</code> that’s unbounded on the left and “too big”:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw"><a href="../../reference/sheets_edit.html">sheets_edit</a></span>(ss_edit, <span class="dt">data =</span> df, <span class="dt">range =</span> <span class="st">"B2:6"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_this</span>()</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#&gt; Editing "sheets-edit-demo"</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#&gt; Writing to sheet "Sheet1"</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt; Reading from "sheets-edit-demo"</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt; Range "Sheet1"</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#&gt; # A tibble: 7 x 7</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#&gt;   A     B     C     D     E     F     G    </span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#&gt; 1 -     -     -     -     -     -     -    </span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#&gt; 2 -     V1    V2    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#&gt; 3 -     A     X     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#&gt; 4 -     B     Y     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#&gt; 5 -     C     Z     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#&gt; 6 -     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#&gt; 7 -     -     -     -     -     -     -</span></span></code></pre></div>
<p>The target sheet will be expanded, if necessary, if and only if <code>range</code> is a single cell (i.e. it gives the upper left corner).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw"><a href="../../reference/sheets_edit.html">sheets_edit</a></span>(ss_edit, <span class="dt">data =</span> df, <span class="dt">range =</span> <span class="st">"G6"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_this</span>()</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co">#&gt; Editing "sheets-edit-demo"</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">#&gt; Writing to sheet "Sheet1"</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">#&gt; Changing dims: (7 x 7) --&gt; (9 x 8)</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co">#&gt; Reading from "sheets-edit-demo"</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">#&gt; Range "Sheet1"</span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co">#&gt; # A tibble: 9 x 8</span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co">#&gt;   A     B     C     D     E     F     G     H    </span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co">#&gt; 1 -     -     -     -     -     -     -     &lt;NA&gt; </span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">#&gt; 2 -     -     -     -     -     -     -     &lt;NA&gt; </span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">#&gt; 3 -     -     -     -     -     -     -     &lt;NA&gt; </span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">#&gt; 4 -     -     -     -     -     -     -     &lt;NA&gt; </span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="co">#&gt; 5 -     -     -     -     -     -     -     &lt;NA&gt; </span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="co">#&gt; 6 -     -     -     -     -     -     V1    V2   </span></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="co">#&gt; 7 -     -     -     -     -     -     A     X    </span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="co">#&gt; 8 &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  B     Y    </span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="co">#&gt; 9 &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  C     Z</span></span></code></pre></div>
<p>Although the <code>data</code> argument of <code><a href="../../reference/sheets_edit.html">sheets_edit()</a></code> must be a data frame, note that this does not actually limit what you can write:</p>
<ul>
<li>Use <code>col_names = FALSE</code> to suppress sending the column names.</li>
<li>By definition, each variable of a data frame can be of different type.</li>
<li>By using a list-column, each row of a data frame column can be of different type.</li>
</ul>
<p>The examples for <code><a href="../../reference/sheets_edit.html">sheets_edit()</a></code> show writing data of disparate type to a 1-row or a 1-column region.</p>
<div id="clean-up-3" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-3" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw"><a href="../../reference/sheets_find.html">sheets_find</a></span>(<span class="st">"sheets-edit-demo"</span>) <span class="op">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">  </span>googledrive<span class="op">::</span><span class="kw"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span>()</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt; Files trashed:</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">#&gt;   * sheets-edit-demo: 13TtqJqx02fVN5pQ1bsatiQCnA5ZdgMCuA1JuzenGurI</span></span></code></pre></div>
</div>
</div>
<div id="write-formulas" class="section level2">
<h2 class="hasAnchor">
<a href="#write-formulas" class="anchor"></a>Write formulas</h2>
<p>All the writing functions can write <em>formulas</em> into cells, if you indicate this in the R object you are writing, i.e. in the data frame. The <code><a href="../../reference/sheets_formula.html">sheets_formula()</a></code> function marks a character vector as containing Sheets formulas, as opposed to regular character strings.</p>
<p>Here’s a demo that also shows off using the Google Translate API inside a Sheet.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>lang_dat &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</span>
<span id="cb29-2"><a href="#cb29-2"></a>       <span class="op">~</span><span class="st"> </span>english, <span class="op">~</span><span class="st"> </span>to,</span>
<span id="cb29-3"><a href="#cb29-3"></a>           <span class="st">"dog"</span>, <span class="st">"es"</span>,</span>
<span id="cb29-4"><a href="#cb29-4"></a>   <span class="st">"hello world"</span>, <span class="st">"ko"</span>,</span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="st">"baby turtles"</span>, <span class="st">"th"</span> </span>
<span id="cb29-6"><a href="#cb29-6"></a>)</span>
<span id="cb29-7"><a href="#cb29-7"></a>lang_dat<span class="op">$</span>translated &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_formula.html">sheets_formula</a></span>(</span>
<span id="cb29-8"><a href="#cb29-8"></a>  <span class="st">'=GoogleTranslate(INDIRECT("R[0]C[-2]", FALSE), "en", INDIRECT("R[0]C[-1]", FALSE))'</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>)</span>
<span id="cb29-10"><a href="#cb29-10"></a></span>
<span id="cb29-11"><a href="#cb29-11"></a>(ss &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/sheets_create.html">sheets_create</a></span>(<span class="st">"sheets-formula-demo"</span>, <span class="dt">sheets =</span> lang_dat))</span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co">#&gt;   Spreadsheet name: sheets-formula-demo</span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co">#&gt;                 ID: 1ueYp27-1bHBEXvvm63ksdNx74JLk7aLPDG_r1dRxXF0</span></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="co">#&gt;             Locale: en_US</span></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="co">#&gt;          Time zone: Etc/GMT</span></span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="co">#&gt;        # of sheets: 1</span></span>
<span id="cb29-17"><a href="#cb29-17"></a><span class="co">#&gt; </span></span>
<span id="cb29-18"><a href="#cb29-18"></a><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="co">#&gt;     lang_dat: 4 x 3</span></span></code></pre></div>
<p>Now we can read the data back out, complete with translations!</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw"><a href="../../reference/read_sheet.html">sheets_read</a></span>(ss)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">#&gt; Reading from "sheets-formula-demo"</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">#&gt; Range "lang_dat"</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co">#&gt; # A tibble: 3 x 3</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co">#&gt;   english      to    translated     </span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;          </span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">#&gt; 1 dog          es    perro          </span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="co">#&gt; 2 hello world  ko    안녕하세요 세계</span></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="co">#&gt; 3 baby turtles th    ลูกเต่า</span></span></code></pre></div>
<div id="clean-up-4" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-4" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw"><a href="../../reference/sheets_find.html">sheets_find</a></span>(<span class="st">"sheets-formula-demo"</span>) <span class="op">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="st">  </span>googledrive<span class="op">::</span><span class="kw"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span>()</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#&gt; Files trashed:</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">#&gt;   * sheets-formula-demo: 1ueYp27-1bHBEXvvm63ksdNx74JLk7aLPDG_r1dRxXF0</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#auth">Auth</a></li>
      <li><a href="#sheets_create"><code>sheets_create()</code></a></li>
      <li><a href="#write_sheet-a-k-a--sheets_write"><code>write_sheet()</code>, a.k.a. <code>sheets_write()</code></a></li>
      <li><a href="#sheets_append"><code>sheets_append()</code></a></li>
      <li><a href="#sheets_edit"><code>sheets_edit()</code></a></li>
      <li><a href="#write-formulas">Write formulas</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="tidyverse">
  <p>googlesheets4 is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="https://jennybryan.org">Jennifer Bryan</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
